<html>
	<head>
		<meta http-equiv=Content-Type content="text/html;charset=utf-8">
		<title>Map Editor</title>
		<link rel="stylesheet" href="css/style.css">
		<script type="text/javascript" src="js/util.js"></script>
		<script type="text/javascript" src="js/compress.js"></script>
		<script type="text/javascript" src="js/main.js"></script>
	</head>
	
	<script>
		function start(){
			PersistManager.init();
			DataManager.init();
			SrcMapManager.init();
			ToolManager.init();
			TargetMapManager.init();
			
		}
	</script>
	<body onload="start()" >
		<div class="container" onselectstart="return false">
			<div class="leftPanel">
				<div class="options">地图大小,
				x:<input type="number" id="mapSizeX" value="1024" min="100"> y:<input type="number" id="mapSizeY" value="768" min="100">
				<button name="mapSizer" id="mapSizer">确定</button>
				<div><input type="text" id="mapsrc" /><button id="setMapSrc">确定</button></div>
				<div>目标设备块单位：<input type="number" id="mapUnit" value="32"><button id="setMapUnit">确定</button></div>
				<div id="selectedElement"></div>
				</div>
				
				<div>
					<button name="shareMap" id="shareMap">共享地图</button>
				</div>
				<div>
					<button name="exportMap" id="exportMap">导出地图</button>
					<button name="saveMap" id="saveMap">保存</button>
					<button name="selectMap" id="selectMap">加载</button>
					<button name="selectJSONMap" id="selectJSONMap">加载JSON地图</button>
				</div>
				<canvas id="srcCanvas" width="300" height="600"></canvas>
				<div id="maskLayer" width="0" height="0"></div>
			</div>
			<div class="tools">
				<button id="continueModeBtn" value="continues">进入连续模式</button>
				<button id="deleteClip" value="delete">进入删除模式</button>
				<button id="editProp" value="edit">设置  属性</button>
				<fieldset>
					<legend>图层</legend>
					<input type="checkbox" id="showAllLayer">ALL</input>
					<button type="button" id="addNewLayer">增加</button>
					<button type="button" id="cleanMap">清除</button>
				</fieldset>
			</div>
			<div class="rightPanel">
				<canvas id="targetCanvas" width="1024" height="768"></canvas>
				<div id="maskLayer2" width="0" height="0"></div>
			</div>
		</div>
		<canvas id="hiddenCanvas" width="1024" height="768" style="display:none" onselectstart="return false"></canvas>
		<div id="dataconsole" class="hiddenDataConsole">
			<button id="consoleCloseBtn" onselectstart="return false">关闭</button>
			<div id="exporteddata" ></div>
		</div>
		<div id="propEditor" class="hiddenPropEditor">
			<div>
				<ul>
					<li><button id="saveMeta" disabled>存</button></li>
					<li>
						可穿越：<input type="checkbox" name="cross" id="cross">
						可跳跃：<input type="checkbox" name="jump" id="jump">
					</li>
					<li>
						走后面：<input type="checkbox" name="walkBehind" id="walkBehind">
						走前面：<input type="checkbox" name="walkFront" id="walkFront">
					</li>
					<li id="groupSection">
						是否整体：<input type="checkbox" name="groupObject" id="groupObject">
						长：<input type="text" name="groupObjectL" id="groupObjectL">
						宽：<input type="text" name="groupObjectW" id="groupObjectW">
						高：<input type="text" name="groupObjectH" id="groupObjectH">
					</li>
				</ul>
			</div>
			<div>
				<button id="closePropEditor">关闭</button>
			</div>
		</div>
		<dialog id="mapSaverDialog" class="hide">
			文件名：<input id="mapName" /> <button id="mapSaverBtn">保存</button>
			<div id="mapSaveFileNameError" class="error"></div>
		</dialog>
		<dialog id="loadMapDialog" class="hide">
			<div>已有地图：</div>
			<div id="maplist"></div>
		</dialog>
		<dialog id="loadJSONMapDialog" class="hide">
			<div>选择地图：</div>
			<div>
				<input type="file" id="jsonmapfile">
			</div>
		</dialog>
	</body>
</html>